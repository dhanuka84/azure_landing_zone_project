<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" version="28.2.8">
  <diagram name="Microsoft Entra ID — Zero Trust Identity Model" id="0">
    <mxGraphModel dx="748" dy="518" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0" adaptiveColors="none">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Microsoft Entra ID — Zero Trust Identity Model (UAMI &amp; OIDC)" style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="20" y="10" width="700" height="40" as="geometry" />
        </mxCell>
        <mxCell id="tenant" value="Entra ID Tenant&#xa;(Users, Groups, Workload Identities)" style="rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="20" y="70" width="360" height="90" as="geometry" />
        </mxCell>
        <mxCell id="groups" value="Groups&#xa;- Dev Team Group&#xa;- AKS Admins Group&#xa;(Access via PIM)" style="rounded=1;fillColor=#f0f9ff;strokeColor=#0284c7;align=left;verticalAlign=top;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="20" y="180" width="360" height="110" as="geometry" />
        </mxCell>
        <mxCell id="workload_identities" value="        Workload Identities (Credential-less)" style="rounded=1;dashed=1;fillColor=#ffffff;strokeColor=#000000;align=left;verticalAlign=top;spacing=6;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="20" y="310" width="360" height="340" as="geometry" />
        </mxCell>
        <mxCell id="cicd_oidc" value="CI/CD Pipeline (OIDC Federation)" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;spacing=6;" parent="workload_identities" vertex="1">
          <mxGeometry x="20" y="40" width="320" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cicd_items" value="- azdo-oidc-platform&#xa;- azdo-oidc-nonprod&#xa;- azdo-oidc-prod&#xa;(Federated Credential - No Secrets)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontSize=11;" parent="cicd_oidc" vertex="1">
          <mxGeometry x="10" y="30" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="app_uami" value="Application Workloads (UAMI)" style="rounded=1;fillColor=#dcfce7;strokeColor=#16a34a;align=left;verticalAlign=top;spacing=6;" parent="workload_identities" vertex="1">
          <mxGeometry x="20" y="150" width="320" height="100" as="geometry" />
        </mxCell>
        <mxCell id="app_uami_items" value="- uami-prod-api-workload&#xa;- uami-qa-api-workload&#xa;- uami-dev-api-workload&#xa;(User-Assigned Managed Identity)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontSize=11;" parent="app_uami" vertex="1">
          <mxGeometry x="10" y="30" width="300" height="60" as="geometry" />
        </mxCell>
        <mxCell id="infra_uami" value="Infrastructure Services (UAMI)" style="rounded=1;fillColor=#e0f2fe;strokeColor=#0ea5e9;align=left;verticalAlign=top;spacing=6;" parent="workload_identities" vertex="1">
          <mxGeometry x="20" y="260" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="infra_uami_items" value="- uami-prod-appgw (For Key Vault Access)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontSize=11;" parent="infra_uami" vertex="1">
          <mxGeometry x="10" y="30" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="rbac" value="    Typical RBAC Assignments (Least Privilege)" style="rounded=1;fillColor=#fefce8;strokeColor=#a16207;align=left;verticalAlign=top;spacing=8;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="70" width="420" height="240" as="geometry" />
        </mxCell>
        <mxCell id="rbac_items" value="CI/CD OIDC Identities (Assigned OUTSIDE TF State):&#xa;&#xa;  • azdo-oidc-prod SP → AcrPush (Prod ACR), AKS Cluster Admin&#xa; (Prod AKS), Contributor (Prod Sub)&#xa;  • azdo-oidc-nonprod SP → Contributor (Dev/QA Subs)&#xa;  • azdo-oidc-platform SP → Contributor (Conn Sub)&#xa;&#xa;Application UAMIs (Assigned INSIDE TF State):&#xa;&#xa;  • uami-*-api → Key Vault Secrets User (Env KV)&#xa;&#xa;Infrastructure UAMIs (Assigned INSIDE TF State):&#xa;&#xa;  • uami-prod-appgw → Key Vault Secrets User (Prod KV)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontSize=11;" parent="rbac" vertex="1">
          <mxGeometry x="10" y="30" width="400" height="200" as="geometry" />
        </mxCell>
        <mxCell id="envs" value="Environment Alignment via Management Groups" style="rounded=1;fillColor=#f0f9ff;strokeColor=#0284c7;align=left;verticalAlign=top;spacing=8;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="330" width="420" height="150" as="geometry" />
        </mxCell>
        <mxCell id="env_items" value="Platform MG:&#xa;  • Connectivity Subscription&#xa;Non-Production MG:&#xa;  • Dev Subscription&#xa;  • QA Subscription&#xa;Production MG:&#xa;  • Prod Subscription" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontSize=11;" parent="envs" vertex="1">
          <mxGeometry x="10" y="30" width="400" height="110" as="geometry" />
        </mxCell>
        <mxCell id="notes" value="Key Principles &amp; Notes" style="rounded=1;fillColor=#cfe2f3;strokeColor=#3d85c6;align=left;verticalAlign=top;spacing=8;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="500" width="420" height="150" as="geometry" />
        </mxCell>
        <mxCell id="notes_items" value="✅ Eliminate Static Secrets: Use OIDC for external systems (CI/CD) and&#xa; UAMI for Azure workloads.&#xa;✅ Least Privilege: Assign roles scoped to specific resources/groups.&#xa;✅ Declarative RBAC (UAMI): Manage UAMI role assignments within Terraform.&#xa;✅ External RBAC (OIDC): Manage OIDC SP roles in Entra ID.&#xa;✅ PIM for Admins: Use Just-in-Time access for human operators." style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontSize=11;" parent="notes" vertex="1">
          <mxGeometry x="9.999999999999998" y="30" width="399.99999999999994" height="110" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
