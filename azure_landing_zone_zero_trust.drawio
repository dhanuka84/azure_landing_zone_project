<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" version="28.2.8">
  <diagram name="Azure Landing Zone – Zero Trust Enhanced" id="0">
    <mxGraphModel dx="2860" dy="552" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="1169" math="0" shadow="0" adaptiveColors="none">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Azure Landing Zone — Zero Trust Enhanced Architecture (Terraform + Azure DevOps OIDC + UAMI)" style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="20" y="10" width="1160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="billing" value="Billing Account&#xa;(Enterprise Agreement / MCA)" style="rounded=1;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="40" y="80" width="240" height="70" as="geometry" />
        </mxCell>
        <mxCell id="entra" value="Microsoft Entra ID Tenant&#xa;- Users, Groups (PIM for Admins)&#xa;- Workload Identities:&#xa;  - OIDC for CI/CD (azdo-oidc-*)&#xa;  - UAMI for Workloads (uami-*-api)" style="rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="320" y="80" width="400" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cicd" value="Azure DevOps CI/CD Pipeline&#xa;- Service Connections (OIDC):&#xa;  azrm-oidc-platform | azrm-oidc-nonprod | azrm-oidc-prod&#xa;- Stages: platform_mg → connectivity → dev → qa → prod&#xa;(Secret-less Auth)" style="rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;spacing=6;" parent="1" vertex="1">
          <mxGeometry x="760" y="80" width="420" height="100" as="geometry" />
        </mxCell>
        <mxCell id="mg_hierarchy" value="" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="-20" y="230" width="1180" height="470" as="geometry" />
        </mxCell>
        <mxCell id="platform_mg" value="    MG: Platform&#xa;Policy: Deny Public IP Creation" style="rounded=1;fillColor=#f0f9ff;strokeColor=#0284c7;align=left;verticalAlign=top;spacing=6;fontSize=11;fontStyle=1;" parent="mg_hierarchy" vertex="1">
          <mxGeometry x="434.7368421052632" y="30" width="279.4736842105263" height="370" as="geometry" />
        </mxCell>
        <mxCell id="connectivity" value="     Subscription: Connectivity&#xa;     rg-platform-connectivity" style="rounded=1;dashed=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;verticalAlign=top;spacing=6;" parent="platform_mg" vertex="1">
          <mxGeometry x="14.335964912280701" y="50" width="244.43596491228072" height="300" as="geometry" />
        </mxCell>
        <mxCell id="hub_vnet" value="Hub VNet: vnet-hub-weu&#xa;(Associated w/ DDoS Plan)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontStyle=1" parent="connectivity" vertex="1">
          <mxGeometry x="16.830526315789474" y="63.61749999999999" width="210.7645614035088" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hub_subnets" value="- AzureFirewallSubnet (Firewall)&#xa;- GatewaySubnet (Optional)&#xa;- AzureBastionSubnet (Mandatory NSG)" style="text;align=left;verticalAlign=top;spacing=2;fontSize=10;" parent="hub_vnet" vertex="1">
          <mxGeometry y="32" width="210.7645614035088" height="56" as="geometry" />
        </mxCell>
        <mxCell id="dns_ddos" value="Private DNS Zones (Central)&#xa;DDoS Protection Plan" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;" parent="connectivity" vertex="1">
          <mxGeometry x="16.830526315789474" y="209.99999999999997" width="210.7645614035088" height="56.0025" as="geometry" />
        </mxCell>
        <mxCell id="prod_mg" value="            MG: Production" style="rounded=1;fillColor=#dcfce7;strokeColor=#16a34a;align=left;verticalAlign=top;spacing=6;fontSize=11;fontStyle=1;" parent="mg_hierarchy" vertex="1">
          <mxGeometry x="734.9122807017544" y="30" width="424.3859649122807" height="370" as="geometry" />
        </mxCell>
        <mxCell id="prod" value="        Subscription: Prod&#xa;        rg-prod-app-services" style="rounded=1;dashed=1;fillColor=#b0e3e6;strokeColor=#0e8088;align=left;verticalAlign=top;spacing=6;" parent="prod_mg" vertex="1">
          <mxGeometry x="20.701754385964914" y="40" width="382.98245614035085" height="310" as="geometry" />
        </mxCell>
        <mxCell id="prod_vnet" value="Spoke VNet: vnet-prod-spoke&#xa;(Peered, UDR, DNS Linked)&#xa;(Associated w/ DDoS Plan)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontStyle=1" parent="prod" vertex="1">
          <mxGeometry x="10.350877192982457" y="53.44827586206896" width="175.96491228070175" height="235.17241379310343" as="geometry" />
        </mxCell>
        <mxCell id="prod_subnets" value="- snet-aks-nodes (Default NSG)&#xa;- snet-private-endpoints (Default NSG)&#xa;- snet-app-gateway (AppGW NSG)&#xa;- snet-apim (APIM NSG)" style="text;align=left;verticalAlign=top;spacing=2;fontSize=10;" parent="prod_vnet" vertex="1">
          <mxGeometry y="53.44827586206896" width="175.96491228070175" height="106.89655172413792" as="geometry" />
        </mxCell>
        <mxCell id="prod_workload" value="Prod Resources:" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;" parent="prod" vertex="1">
          <mxGeometry x="196.66666666666666" y="53.44827586206896" width="175.96491228070175" height="235.17241379310343" as="geometry" />
        </mxCell>
        <mxCell id="prod_items" value="- App Gateway (WAF) [Public IP]&#xa;- API Management (Internal)&#xa;- AKS: aks-prod-main (Internal LB)&#xa;- ACR: acr-prod-main (PE)&#xa;- KV: kv-prod-secrets (PE)&#xa;- UAMI: uami-prod-api" style="text;align=left;verticalAlign=top;spacing=2;fontSize=10;strokeColor=#00331A;" parent="prod_workload" vertex="1">
          <mxGeometry y="21.379310344827584" width="175.96491228070175" height="203.10344827586206" as="geometry" />
        </mxCell>
        <mxCell id="note_appgw" value="Traffic via App Gateway (WAF)" style="text;fontSize=10;fontStyle=4;" parent="mg_hierarchy" vertex="1">
          <mxGeometry x="993.6842105263157" y="410" width="144.91228070175438" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nonprod_mg" value="            MG: Non-Production" style="rounded=1;fillColor=#fefce8;strokeColor=#a16207;align=left;verticalAlign=top;spacing=6;fontSize=11;fontStyle=1;" parent="mg_hierarchy" vertex="1">
          <mxGeometry x="20.344827586206897" y="30" width="393.69275862068963" height="370" as="geometry" />
        </mxCell>
        <mxCell id="dev" value="Subscription: Dev&#xa;rg-dev-user-a" style="rounded=1;dashed=1;fillColor=#b1ddf0;strokeColor=#10739e;align=left;verticalAlign=top;spacing=6;" parent="nonprod_mg" vertex="1">
          <mxGeometry x="9.602262405382675" y="40" width="172.84072329688811" height="310" as="geometry" />
        </mxCell>
        <mxCell id="dev_vnet" value="Spoke VNet: vnet-dev-spoke&#xa;(Peered, UDR, DNS Linked)&#xa;(Associated w/ DDoS Plan)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontStyle=1" parent="dev" vertex="1">
          <mxGeometry x="10.167101370405183" y="53.44827586206896" width="152.50652055607776" height="106.89655172413792" as="geometry" />
        </mxCell>
        <mxCell id="dev_subnets" value="- snet-workload (Default NSG)&#xa;- snet-private-endpoints &#xa;(Default NSG)" style="text;align=left;verticalAlign=top;spacing=2;fontSize=10;" parent="dev_vnet" vertex="1">
          <mxGeometry y="53.44827586206896" width="152.50652055607776" height="53.44827586206896" as="geometry" />
        </mxCell>
        <mxCell id="dev_workload" value="Dev Resources:&#xa;AKS, ACR, KV&#xa;UAMI: uami-dev-api&#xa;(Private Endpoints)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;" parent="dev" vertex="1">
          <mxGeometry x="10.167101370405183" y="171.03448275862067" width="152.50652055607776" height="106.89655172413792" as="geometry" />
        </mxCell>
        <mxCell id="qa" value="Subscription: QA&#xa;rg-qa-app-services" style="rounded=1;dashed=1;fillColor=#fad9d5;strokeColor=#ae4132;align=left;verticalAlign=top;spacing=6;" parent="nonprod_mg" vertex="1">
          <mxGeometry x="192.04524810765346" y="40" width="192.04524810765346" height="310" as="geometry" />
        </mxCell>
        <mxCell id="qa_vnet" value="Spoke VNet: vnet-qa-spoke&#xa;(Peered, UDR, DNS Linked)&#xa;(Associated w/ DDoS Plan)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;fontStyle=1" parent="qa" vertex="1">
          <mxGeometry x="10.669180450425193" y="53.44827586206896" width="170.7068872068031" height="106.89655172413792" as="geometry" />
        </mxCell>
        <mxCell id="qa_subnets" value="- snet-aks-nodes (Default NSG)&#xa;- snet-private-endpoints &#xa;(Default NSG)" style="text;align=left;verticalAlign=top;spacing=2;fontSize=10;" parent="qa_vnet" vertex="1">
          <mxGeometry y="53.44827586206896" width="170.7068872068031" height="53.44827586206896" as="geometry" />
        </mxCell>
        <mxCell id="qa_workload" value="QA Resources:&#xa;AKS, ACR, KV&#xa;UAMI: uami-qa-api&#xa;(Private Endpoints)" style="rounded=0;fillColor=#ffffff;strokeColor=none;align=left;verticalAlign=top;spacing=4;" parent="qa" vertex="1">
          <mxGeometry x="10.669180450425193" y="171.03448275862067" width="170.7068872068031" height="106.89655172413792" as="geometry" />
        </mxCell>
        <mxCell id="peer1" value="VNet Peering" style="edgeStyle=orthogonalEdgeStyle;dashed=1;strokeColor=#000000;" parent="mg_hierarchy" source="connectivity" target="dev_vnet" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="279.4736842105263" y="230" />
              <mxPoint x="502.01754385964915" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="peer2" value="VNet Peering" style="edgeStyle=orthogonalEdgeStyle;dashed=1;strokeColor=#000000;entryX=1;entryY=0;entryDx=0;entryDy=0;exitX=-0.002;exitY=0.327;exitDx=0;exitDy=0;exitPerimeter=0;" parent="mg_hierarchy" source="connectivity" target="qa_subnets" edge="1">
          <mxGeometry x="0.0637" y="-17" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="449" y="177" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="peer3" value="VNet Peering" style="edgeStyle=orthogonalEdgeStyle;dashed=1;strokeColor=#000000;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="mg_hierarchy" source="prod_subnets" target="connectivity" edge="1">
          <mxGeometry x="-0.0059" y="10" relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="-18.06422203532378" y="214.5" as="sourcePoint" />
            <mxPoint x="462.04889823380984" y="214.5" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="deploy1" value="Deploy Platform (Terraform)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#001DBC;fillColor=#0050ef;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="cicd" target="connectivity" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="870" y="210" />
              <mxPoint x="551" y="210" />
            </Array>
            <mxPoint x="870" y="210" as="sourcePoint" />
            <mxPoint x="160" y="320" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="deploy2" value="Deploy Non-Prod (Terraform)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#005700;fillColor=#008a00;" parent="1" source="cicd" target="nonprod_mg" edge="1">
          <mxGeometry x="0.4537" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="970" y="240" />
              <mxPoint x="197" y="240" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="deploy3" value="Deploy Prod (Terraform + Approval)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#005700;fillColor=#008a00;" parent="1" source="cicd" target="prod_mg" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1070" y="280" />
              <mxPoint x="915" y="280" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="internet" value="Internet" style="ellipse;shape=cloud;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="940" y="720" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="traffic_flow" value="HTTPS" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=classic;endFill=1;strokeWidth=2;exitX=0.4;exitY=0.1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="internet" target="prod_items" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="988" y="670" />
              <mxPoint x="1200" y="670" />
              <mxPoint x="1200" y="380" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
